import tensorflow as tf


# y_true = tf.constant(
#     [[0, 0, 2, 2, 0, 0],
#      [0, 2, 1, 1, 2, 0],
#      [0, 2, 1, 1, 2, 0],
#      [0, 0, 2, 2, 0, 0]]
# )
# y_pred = tf.constant(
#     [[0, 0, 2, 2, 0, 0],
#      [0, 1, 1, 1, 2, 0],
#      [0, 1, 1, 1, 2, 0],
#      [0, 0, 1, 2, 0, 0]]
# )
# Ground truth IOU: 0.73214287


y_true = tf.constant(
    [
        [
            [1.0, 1.0, 0.0, 0.0, 1.0, 1.0],
            [1.0, 0.0, 0.0, 0.0, 0.0, 1.0],
            [1.0, 0.0, 0.0, 0.0, 0.0, 1.0],
            [1.0, 1.0, 0.0, 0.0, 1.0, 1.0],
        ],
        [
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
            [0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        ],
        [
            [0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
        ],
    ]
)
y_pred = tf.constant(
    [
        [
            [0.7, 0.7, 0.2, 0.2, 0.7, 0.7],
            [0.7, 0.2, 0.1, 0.1, 0.2, 0.7],
            [0.7, 0.2, 0.1, 0.1, 0.2, 0.7],
            [0.7, 0.7, 0.2, 0.2, 0.7, 0.7],
        ],
        [
            [0.1, 0.1, 0.2, 0.2, 0.1, 0.1],
            [0.1, 0.7, 0.7, 0.7, 0.2, 0.1],
            [0.1, 0.7, 0.7, 0.7, 0.2, 0.1],
            [0.1, 0.1, 0.7, 0.2, 0.1, 0.1],
        ],
        [
            [0.2, 0.2, 0.7, 0.7, 0.2, 0.2],
            [0.2, 0.7, 0.1, 0.1, 0.7, 0.2],
            [0.2, 0.7, 0.1, 0.1, 0.7, 0.2],
            [0.2, 0.2, 0.7, 0.7, 0.2, 0.2],
        ],
    ]
)
y_true = tf.stack([*y_true], axis=2)
y_pred = tf.stack([*y_pred], axis=2)
y_true = tf.expand_dims(y_true, 0)
y_pred = tf.expand_dims(y_pred, 0)
